<html>
    <header>
        <link rel="stylesheet" href="/themes/{$THEMENAME}/styles.css">
        <link rel="stylesheet" href="/themes/{$THEMENAME}/help.css">
    </header>
    <body>
        <h1>{$node_name}</h1>
<p>The "New Endpoint Configurator" module enables automatic remote configuration
of supported endpoints. This module combines the functionality of the old "Endpoint
Configurator" and "Batch of Endpoints" modules into a single, completely rewritten
interface. With this module, the Elastix administrator can point supported endpoints
to the Elastix server as their telephony server.</p>

<h3>Table of contents</h3>
<ol>
<li><a href="#terms">Definition of terms</a></li>
<li><a href="#interface">Interface description</a></li>
<li><a href="#workflow_manual">Workflow for manual parameter configuration</a></li>
<li><a href="#workflow_file">Workflow for parameter configuration through file upload</a></li>
<li><a href="#file_formats">Endpoint list file formats</a></li>
<li><a href="#supported">Supported endpoint manufacturers</a></li>
</ol>

<h3><a id="terms">Definition of terms</a></h3>
<p>The following are terms used in the rest of this document:</p>
<dl>
<dt>Endpoint</dt>
<dd>An endpoint is a hardware device or software that implements at least one 
telephony technology stack (such as SIP or IAX2) and is capable of placing and 
receiving VoIP calls on behalf of an end user. This is most often a VoIP phone. 
In order to place and receive calls, the endpoint must be configured with a 
telephony proxy server, and at least one telephony account on this proxy server.
An endpoint may support more than one account, and possibly more than one VoIP 
technology.</dd>

<dt>Account</dt>
<dd>An account is an authentication/authorization record created on a telephony 
server for the purpose of routing calls. The bare minimum information to configure
an account is the VoIP technology used to talk with the phone, an account name, 
and a shared secret. Frequently the account also has a Display Name, a friendly
string that describes the account. On single-tenant setups, the account name may
be the same as the extension that should be dialed to reach this account. On
multi-tenant setups (such as Elastix 3), the account name must necessarily 
contain disambiguating information beyond (or instead of) the extension to dial.</dd>

<dt>Telephony server</dt>
<dd>A telephony server is a computer server that runs a telephony PBX or 
switching software (such as Asterisk). The telephony server is responsible for
routing calls between extensions and outside sources (such as VoIP and PSTN 
telephony trunks). This routing involves resolving a dialed number from an 
endpoint, or entered through an IVR, into an existing account to which the call
should be bridged. For the purposes of this module, the Elastix server plays the
role of the telephony server.</dd>

<dt>VoIP technology (or "tech")</dt>
<dd>A VoIP technology is a particular network protocol that encodes the required
interactions between the endpoint and the telephony server, such as signaling
an incoming call, placing a call, negotiation of codecs, and tearing down of a
call. Currently the supported VoIP technologies on the module are SIP and IAX2.</dd>

<dt>Extension</dt>
<dd>An extension is a fixed string composed of digits (0-9) plus the special characters
pound (#) and asterisk (*), which can be dialed through the keyboard of an endpoint,
and can be interpreted by the telephony server as a particular telephony resource.
The particular telephony resource can be an account, a queue, an IVR, a conference
room, or some other behavior. On Asterisk/Elastix, the mapping between extensions
and telephony resources is defined by the dialplan configured in extensions.conf
and its included files. On simple PBX setups, there is only one mapping between
an extension and a telephony resource, frequently an account to which the
call should be bridged. On multi-tenant setups (such as Elastix 3), each domain
defines its own extension namespace with extensions that are unique inside
each domain.</dd>

<dt>Static provisioning</dt>
<dd>The factory-default setting for many, if not all, of the supported endpoints
is to use DHCP to get an IP in the local network. The DHCP protocol supports
sending properties in addition to the available IP, such as the address of a
TFTP server from which configuration files may be downloaded. If the Elastix
server is the DHCP server for the network, it will point the TFTP server at itself.
However, frequently the DHCP server is a different server and not under the control
of Elastix. This results in the TFTP directory configuration being absent, or 
reused for purposes other than phone provisioning. An endpoint supports static
provisioning if the way the endpoint is configured allows the phone to ignore
absent or invalid server configuration from DHCP, and always fetch the configuration
files from the Elastix server. This property simplifies deployment of the endpoints
in networks where the DHCP server is unable or unwilling to point TFTP at the
Elastix server. </dd>

</dl>

<h3><a id="interface">Interface description</a></h3>

<p>The main interface of the module is as follows:</p>

(TODO: insertar imagen)

<dl>
<dt>Main listing</dt>
<dd>This is the listing of all endpoints that have been detected or entered. Unlike
the old implementation, any endpoints detected or uploaded in past sessions will
be kept and displayed until they are explicitly erased. The main listing contains
the following columns:
<ul>
<li>Selection checkbox. By selecting this, the endpoint is marked for subsequent
configuration or removal from the list. The header contains a global checkbox
that will check/uncheck all endpoints.</li>
<li>Endpoint status. This displays the status of the endpoint as one or more 
icons. The available flags are as follows:
    <ul>
        <li>Scroll icon: the endpoint has not been scanned, but rather defined in an upload.</li>
        <li>Disk icon: the endpoint configuration has been updated in the database but not yet applied to its configuration files.</li>
        <li>Person icon: the endpoint has at least one endpoint assigned.</li>
    </ul>
</li>
<li>MAC Address. This is the main identifier for the endpoint. Configurations in
the database and uploaded files are considered to refer to the same endpoint if
they reference the same MAC address.</li>
<li>Current IP. If the endpoint was detected through a scan, this field will show
the IP at which the endpoint was found. This field is a link to the HTTP 
configuration interface (if supported) of the phone.</li>
<li>Manufacturer. This displays the detected manufacturer of the endpoint.</li>
<li>Model. This displays the detected model of the endpoint. Since automatic model
detection is not (yet) implemented for some manufacturers, this field allows the
user to correct the model via a drop-down list. Accurate model detection is 
required for many other features (such as account assignment) to work.</li>
<li>Options. This link displays a modal dialog on which common options for the
endpoint can be manually configured.</li>
</ul>
</dd>

<dt><img src="../../images/searchw.png"/>Endpoint scan toolbar button</dt>
<dd>This widget contains a textbox with a network/netmask definition, and a magnifying
glass icon. By default, the network definition will be filled with the network
definition of the first ethernet interface of the Elastix server. The user may
correct this definition to restrict the scan, and then click on the icon to start
the scan. When scanning, the toolbar will change to a spinning icon and a Cancel
button. As endpoints are detected, they will be added to the main listing, along
with their detected manufacturer and model. The toolbar will revert to its
default state when the scan is done, or if the scan is aborted with the Cancel
button.</dd>

<dt><img src="../../images/endpoint.png"/>Endpoint configuration toolbar button</dt>
<dd>Clicking on this icon will start applying the configuration for all selected
endpoints (all endpoints for which the checkbox is set). When applying the 
configuration, the toolbar will change to a progress bar. As endpoints are
configured, the progress bar will update, and the toolbar will revert to the
default state when the configuration is done. During configuration, a log is
generated, and can be viewed by clicking on the Configuration Log toolbar button.</dd>

<dt><img src="../../images/list.png"/>Configuration Log toolbar button</dt>
<dd>Clicking on this icon will open a modal dialog in which a log of the last
configuration run will be shown. This is useful for diagnosing issues with the
module failing to configure an endpoint.</dd>

<dt><img src="../../images/delete5.png"/>Forget configuration toolbar button</dt>
<dd>Clicking on this icon will (after a confirmation dialog) remove the database
records for the selected endpoints, as well as any generated configuration files
for these endpoints. It will NOT, however, contact the endpoints themselves in
any way.</dd>


<dt><img src="../../images/download2.png"/>Download toolbar button</dt>
<dd>Clicking on this icon will display a list of links to download the list of
endpoints stored on the database, in three different formats. The supported 
formats are:
<ul>
<li>CSV (Legacy). This is the format used by the old Endpoint Configurator.</li>
<li>XML. This format allows the definition of endpoints with multiple accounts
and properties, as an XML document.</li>
<li>CSV (Nested). This format can be generated by careful editing in a spreadsheet,
and uses indentation to group multiple accounts and properties per endpoint.</li>
</ul></dd>

<dt><img src="../modules/{$node_id}/images/upload.png" border="0" />Upload toolbar button</dt>
<dd>Clicking on this icon will display a small dialog in which the user may specify
an endpoint list file to upload to the server. The file format is automatically 
detected.</dd>

</dl>

<p>The configuration dialog contains the following screens:</p>

(TODO: imagen)

<p>The Information screen displays details on the selected endpoint. These details
include the detected manufacturer and model, MAC and IP, and the maximum number
of configurable accounts for the endpoint, as dictated by the model. Also visible
are various flags that indicate known capabilities for the model.</p>

(TODO: imagen)

<p>The Accounts screen enables assignment of the existing accounts on the system to
the selected endpoint. The screen contains two panels with account entries and
an additional panel of properties that appears when one of the accounts for the 
endpoint is selected. The left panel contains all of the accounts with supported
technologies not assigned to any endpoint. The top right panel contains all of
the accounts assigned to the endpoint, of which the first one will be used as the
primary account on the phone display (if supported). Accounts can be assigned
by dragging them from the left panel onto the right panel, and unassigned by
dragging them in the opposite direction. The assigned accounts may be reordered
to change their priority on the endpoint. Some phone models support assigning
properties for specific accounts. If so, these properties may be entered by
selecting the assigned account, and writing the name and value of the property
in the lower right panel.</p>

(TODO: imagen)

<p>The network screen enables configuration of network parameters. The endpoint
can be switched between DHCP and static network addresses (if supported), and
if configuring as static address, the basic IP parametrers are entered here.</p>

(TODO: imagen)

<p>The credentials screen enables configuration of authentication credentials
that may be required to configure a phone with non-default passwords.</p>

(TODO: imagen)

<p>The Custom Parameters screen allows setting of model-specific parameters not
otherwise supported by the interface. Unlike any parameters entered in the 
Accounts screen, these parameters apply to the endpoint as a whole, rather than
a specific account.</p>

<h3><a id="workflow_manual">Workflow for manual parameter configuration</a></h3>

<p>The following is the recommended procedure for configuring a small number of</p>

<h3><a id="workflow_file">Workflow for parameter configuration through file upload</a></h3>
<h3><a id="file_formats">Endpoint list file formats</a></h3>
<h3><a id="supported">Supported endpoint manufacturers</a></h3>
    </body>
</html>
